
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shop - SportHub</title>
  <link rel="stylesheet" href="../css/main.css" />
  <link rel="stylesheet" href="/css/components/navbar.css" />
  <link rel="stylesheet" href="/css/components/footer.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="../css/pages/shop.css" />
</head>
<body>
  <!-- Navbar Component -->
  <div id="navbar-container"></div>
  
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <h1>Premium Sports Equipment</h1>
      <p>Discover top-quality gear from leading brands for all your sporting adventures</p>
    </div>
  </section>

  <main class="shop-container">
    <!-- Filters Section -->
    <section class="filters-section">
      <div class="filter-container">
        <div class="search-group">
          <i class="fas fa-search"></i>
          <input type="text" id="searchInput" placeholder="Search products, brands, categories..." />
        </div>
        
        <div class="filter-group">
          <select id="categoryFilter">
            <option value="">All Categories</option>
            <option value="Tennis">Tennis</option>
            <option value="Basketball">Basketball</option>
            <option value="Football">Football</option>
            <option value="Badminton">Badminton</option>
            <option value="Swimming">Swimming</option>
            <option value="Volleyball">Volleyball</option>
            <option value="Cricket">Cricket</option>
            <option value="Table Tennis">Table Tennis</option>
          </select>
        </div>
        
        <div class="filter-group">
          <select id="brandFilter">
            <option value="">All Brands</option>
            <option value="Wilson">Wilson</option>
            <option value="Nike">Nike</option>
            <option value="Adidas">Adidas</option>
            <option value="Yonex">Yonex</option>
            <option value="Speedo">Speedo</option>
            <option value="Mikasa">Mikasa</option>
            <option value="Gray Nicolls">Gray Nicolls</option>
            <option value="Butterfly">Butterfly</option>
          </select>
        </div>
        
        <div class="filter-group">
          <select id="priceFilter">
            <option value="">Price Range</option>
            <option value="0-50">$0 - $50</option>
            <option value="50-100">$50 - $100</option>
            <option value="100-200">$100 - $200</option>
            <option value="200+">$200+</option>
          </select>
        </div>
        
        <div class="filter-group">
          <select id="sortFilter">
            <option value="name-asc">Name A-Z</option>
            <option value="name-desc">Name Z-A</option>
            <option value="price-asc">Price Low to High</option>
            <option value="price-desc">Price High to Low</option>
            <option value="rating-desc">Highest Rated</option>
            <option value="newest">Newest First</option>
          </select>
        </div>
      </div>
    </section>

    <!-- Results Section -->
    <section class="results-section">
      <div class="results-header">
        <h2 id="productCount">Loading products...</h2>
        <div class="view-toggle">
          <button id="gridView" class="view-btn active"><i class="fas fa-th"></i></button>
        </div>
      </div>
      
      <div id="productGrid" class="product-grid grid-view"></div>
      <div id="loadingSpinner" class="loading-spinner">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Loading products...</p>
      </div>
      <div id="noResults" class="no-results" style="display: none;">
        <i class="fas fa-search"></i>
        <h3>No products found</h3>
        <p>Try adjusting your filters or search terms</p>
      </div>
    </section>
  </main>

  <!-- Cart Sidebar -->
  <div id="cartSidebar" class="cart-sidebar">
    <div class="cart-header">
      <h3><i class="fas fa-shopping-cart"></i> Shopping Cart</h3>
      <button id="closeCart" class="close-btn">&times;</button>
    </div>
    <div class="cart-content">
      <div id="cartItems"></div>
      <div class="cart-footer">
        <div class="cart-total">
          <strong>Total: $<span id="cartTotal">0.00</span></strong>
        </div>
        <button class="checkout-btn" onclick="proceedToCheckout()">
          <i class="fas fa-credit-card"></i> Checkout
        </button>
      </div>
    </div>
  </div>

  <!-- Cart Button -->
  <button id="cartButton" class="cart-button">
    <i class="fas fa-shopping-cart"></i>
    <span id="cartCount">0</span>
  </button>

  <!-- Footer Component -->
  <div id="footer-container"></div>

  <script src="../js/components/navbar.js"></script>
  <script src="../js/auth.js"></script>
  <script src="../data-utils.js"></script>
  <script src="/js/pages/shop.js"></script>
    <script>
        // Load the shared navbar dynamically
        fetch('/pages/components/navbar.html')
            .then(res => res.text())
            .then(data => {
                document.getElementById('navbar-container').innerHTML = data;
                new Navbar(); // Initialize navbar behavior
            });


        // Load the shared footer dynamically
        fetch('/pages/components/footer.html')
            .then(res => res.text())
            .then(data => {
                document.getElementById('footer-container').innerHTML = data;
            });


        // Global logout function
        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = '/';
        }

        // Checkout function to redirect to payment page
        function proceedToCheckout() {
            const cartItems = shop ? shop.cart : [];
            
            if (cartItems.length === 0) {
                alert('Your cart is empty. Add some items before checkout.');
                return;
            }

            // Calculate total
            const total = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // Store cart data for payment page
            localStorage.setItem('checkoutCart', JSON.stringify(cartItems));
            localStorage.setItem('checkoutTotal', total.toString());
            
            // Redirect to payment page with cart info
            const firstItem = cartItems[0];
            const params = new URLSearchParams({
                item: cartItems.length > 1 ? `${cartItems.length} Sports Items` : firstItem.name,
                description: cartItems.length > 1 ? `Shopping cart with ${cartItems.length} items` : firstItem.description || 'Sports equipment',
                price: total.toFixed(2)
            });
            
            window.location.href = `/pages/payment.html?${params.toString()}`;
        }
    </script>
  
 

</body>
</html>